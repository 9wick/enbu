# Utilityコマンドのテストフロー
# ポート3040を使用（example/utilityサーバー専用ポート）
# テスト用HTTPサーバー（localhost:3040）が起動していることを前提とする

env:
  BASE_URL: http://localhost:3040

steps:
  # ステップ1: ページを開く
  - open: ${BASE_URL}

  # ステップ2: メインタイトルの表示確認
  # "Utility Test"は他の要素にも含まれるため、data-testidを使用
  - assertVisible:
      css: '[data-testid="main-title"]'

  # ステップ3: 2秒待機
  - wait: 2000

  # ステップ4: 遅延表示要素の出現を待機（3秒後に表示される）
  # 新しいanyText形式を使用（agent-browserの wait --text と1:1対応）
  - wait:
      anyText: "遅延表示コンテンツ"

  # ステップ5: 遅延表示要素の確認
  - assertVisible: 遅延表示コンテンツ

  # ステップ6: スクリーンショット保存（通常）
  - screenshot: ./screenshots/page.png

  # ステップ7: スクリーンショット保存（フルページ）
  - screenshot:
      path: ./screenshots/fullpage.png
      full: true

  # ステップ8: JavaScript実行してタイトル取得
  - eval: "document.title"
